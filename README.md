Warning: Old code. Looking to update and publish new version late 2020.
